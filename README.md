# Automatically Generated tests for AWS Encryption SDK for Dafny

This fork of AWS Encryption SDK hosts some tests produced by Dafny's automated test generation tool.
To look at the generated tests, go to `test/autoGenerated` directory. 
You will notice a dozen commented-out tests and lines - these are generated by the tool erroneously and at this point have to be removed manually. 
All remaining 284 auto-generated tests should succeed.

To reproduce the tests, run `make generate`. 
Note that doing so updates your Dafny path for the duration of the console session. 
Also please note that the tool will periodically kill all z3 processes on your machine as some timeout and must be stopped. 
Finally, if you want to run the tests after generating them, you will have to comment out the tests/lines that are also commented out in this repository (`git diff` can help).

To execute all the tests in the `test` directory, run `make test`. 
Running the standard tests that are officially part of the SDK (not the auto-generated ones) will require you to perform certain steps that are outlined [here](https://github.com/aws/aws-encryption-sdk-dafny/blob/mainline/aws-encryption-sdk-net/README.md). 
To exclude certain tests from the coverage report generated at the end, simply move these tests out of the `test` directory. 
Note that I set the value of `DYLD_LIBRARY_PATH` in the `runTests.sh` - you might have to modify this if you have openssl installed at a different location.

I have modified the coverage report so that it only takes into account files directly compiled from Dafny (namespaces containing the `_Compile` substring) since this more accurately reflects the effect of the automatically generated tests.
